<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>FriendFinder</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/styles.css">

</head>

<body class="body-survey">

  <div class="container">
    <div class="header">
      <h2 id="survey">Survey</h2>
    </div>

    <h4>Name (Required)</h4>
    <input type="text" id="name" class="form-control" required>

    <h4>Link to Photo Image (Required)</h4>
    <input type="text" id="photo" class="form-control" required>


    <div class="box">
      <div class="number">#1</div>
      <div class="ques">
          <h4>I know exactly where I would like my life to be in 5 years.</h4>
          <select class="chosen-select menu" id="q1">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
      </div>
    </div>

    <div class="box">
        <div class="number">#2</div>
        <div class="ques">
            <h4>I enjoy exercising</h4>
            <select class="chosen-select menu" id="q2">
              <option value=""></option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Strongly Agree)</option>
            </select>
        </div>
      </div>

      <div class="box">
          <div class="number">#3</div>
          <div class="ques">
              <h4>Watching sports is not really my thing.</h4>
              <select class="chosen-select menu" id="q3">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
          </div>
        </div>

        <div class="box">
            <div class="number">#4</div>
            <div class="ques">
                <h4>My idea of a good time is to go out with a bunch of friends.</h4>
                <select class="chosen-select menu" id="q4">
                  <option value=""></option>
                  <option value="1">1 (Strongly Disagree)</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
          </div>

          <div class="box">
              <div class="number">#5</div>
              <div class="ques">
                  <h4>I prefer to spend my day off on the couch</h4>
                  <select class="chosen-select menu" id="q5">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
              </div>
            </div>

            <div class="box">
                <div class="number">#6</div>
                <div class="ques">
                    <h4>My friends would descrive me as outgoing</h4>
                    <select class="chosen-select menu" id="q6">
                      <option value=""></option>
                      <option value="1">1 (Strongly Disagree)</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5 (Strongly Agree)</option>
                    </select>
                </div>
              </div>

              <div class="box">
                  <div class="number">#7</div>
                  <div class="ques">
                      <h4>I go to bed early</h4>
                      <select class="chosen-select menu" id="q7">
                        <option value=""></option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                      </select>
                  </div>
                </div>

                <div class="box">
                    <div class="number">#8</div>
                    <div class="ques">
                        <h4>I like to challenge myself</h4>
                        <select class="chosen-select menu" id="q8">
                          <option value=""></option>
                          <option value="1">1 (Strongly Disagree)</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="4">4</option>
                          <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                  </div>

                  <div class="box">
                      <div class="number">#9</div>
                      <div class="ques">
                          <h4>I prefer to read a book over watching a movie</h4>
                          <select class="chosen-select menu" id="q9">
                            <option value=""></option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                          </select>
                      </div>
                    </div>

                    <div class="box">
                        <div class="number">#10</div>
                        <div class="ques">
                            <h4>My friends would describe me as organized</h4>
                            <select class="chosen-select menu" id="q10">
                              <option value=""></option>
                              <option value="1">1 (Strongly Disagree)</option>
                              <option value="2">2</option>
                              <option value="3">3</option>
                              <option value="4">4</option>
                              <option value="5">5 (Strongly Agree)</option>
                            </select>
                        </div>
                      </div>
    
    <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Submit My Answers and Find a Friend!</button>

  </div>

  
  <div id="results-modal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title"><strong>Your Match</strong></h2>
        </div>
        <div class="modal-body">
          <h2 id="match-name"></h2>
          <img id="match-img" style="height:300px;" src="" alt="">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>

  <script type="text/javascript">
    
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : { allow_single_deselect: true },
      '.chosen-select-no-single' : { disable_search_threshold: 10 },
      '.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
      '.chosen-select-rtl'       : { rtl: true },
      '.chosen-select-width'     : { width: '95%' }
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }


    
    $("#submit").on("click", function(event) {
      event.preventDefault()

      function validate() {
        var valid = true;
        $(".form-control").each(function() {
          if ($(this).val() === "") {
            valid = false
          }
        });

        $(".chosen-select").each(function() {

          if ($(this).val() === "") {
            valid = false
          }
        });
        return valid
      }

      if (validate()) {
        
        var userObj = {
          name: $("#name").val(),
          photo: $("#photo").val(),
          scores: [
            $("#q1").val(),
            $("#q2").val(),
            $("#q3").val(),
            $("#q4").val(),
            $("#q5").val(),
            $("#q6").val(),
            $("#q7").val(),
            $("#q8").val(),
            $("#q9").val(),
            $("#q10").val()
          ]
        }

        
        $.post("/api/friends", userObj, function(data) {

          $("#match-name").text(data.name)
          $("#match-img").attr("src", data.photo)

          $("#results-modal").modal("toggle")

        });
      } else {
        alert("All fields must be completed before submitting!")
      }
    })
  </script>

</body>

</html>